{"version":3,"file":"js/170.555cbbdd.js","mappings":"8LACSA,MAAM,e,6DAAXC,EAAAA,EAAAA,IAEM,MAFNC,EAEM,EADFC,EAAAA,EAAAA,IAAUC,I,eCDlB,MAAMC,EAAS,CAAC,EAKVC,GAA2B,OAAgBD,EAAQ,CAAC,CAAC,SAASE,GAAQ,CAAC,YAAY,qBAEzF,O,qgBCgGA,MAAMC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAeD,EAAAA,EAAAA,KAAI,GACnBE,GAAkBF,EAAAA,EAAAA,KAAI,GACtBG,GAAaH,EAAAA,EAAAA,KAAI,GACjBI,GAAgBJ,EAAAA,EAAAA,KAAI,GACpBK,GAAmBL,EAAAA,EAAAA,IAAI,CAAC,GACxBM,GAAYN,EAAAA,EAAAA,IAAI,CAClBO,GAAI,GACJC,SAAU,GACVC,aAAc,GACdC,gBAAiB,GACjBC,iBAAkB,GAClBC,wBAAyB,GACzBC,YAAa,MAGjBC,EAAAA,EAAAA,KAAU,KACNC,GAAc,IAGlB,MAAMA,EAAeA,KACjBhB,EAAQiB,OAAQ,GAChBC,EAAAA,EAAAA,IAAe,CACXC,aAAa,IACdC,MAAKC,IACJd,EAAUU,MAAQI,EAAIC,MAAQ,CAAC,EAC/BhB,EAAiBW,OAAQM,EAAAA,EAAAA,IAAQhB,EAAUU,MAAM,IAClDO,SAAQ,KACPxB,EAAQiB,OAAQ,CAAI,GACtB,EAGAQ,EAAeA,KACjB,GAAIvB,EAAae,MACb,IAGI,GAFAb,EAAWa,OAAQ,EACnBV,EAAUU,MAAMP,aAAeH,EAAUU,MAAMP,aAAagB,QACvDnB,EAAUU,MAAMP,aACjB,KAAM,aAEViB,EAAAA,EAAAA,IAAe,CACXjB,aAAcH,EAAUU,MAAMP,eAC/BU,MAAK,KACJQ,EAAAA,GAAQC,QAAQ,OAChB3B,EAAae,OAASf,EAAae,MACnCX,EAAiBW,MAAMP,aAAeH,EAAUU,MAAMP,YAAW,IAClEc,SAAQ,KACPpB,EAAWa,OAAQ,CAAI,GAE/B,CAAE,MAAOa,GACL1B,EAAWa,OAAQ,EACnBW,EAAAA,GAAQG,MAAMD,EAClB,CACJ,EAGEE,EAAqBA,KACvB9B,EAAae,OAAQ,EACrBV,EAAUU,OAAQM,EAAAA,EAAAA,IAAQjB,EAAiBW,MAAM,EAG/CgB,EAAkBA,KACpB,GAAI9B,EAAgBc,MAChB,IAGI,GAFAZ,EAAcY,OAAQ,EACtBV,EAAUU,MAAMH,YAAcP,EAAUU,MAAMH,YAAYY,QACrDnB,EAAUU,MAAMH,YACjB,KAAM,YAEV,IAAKP,EAAUU,MAAMJ,wBACjB,KAAM,YAEVc,EAAAA,EAAAA,IAAe,CACXb,YAAaP,EAAUU,MAAMH,YAC7BD,wBAAyBN,EAAUU,MAAMJ,0BAC1CO,MAAK,KACJQ,EAAAA,GAAQC,QAAQ,OAChB1B,EAAgBc,OAASd,EAAgBc,MACzCX,EAAiBW,MAAMH,YAAcP,EAAUU,MAAMH,YACrDR,EAAiBW,MAAMJ,wBAA0BN,EAAUU,MAAMJ,uBAAsB,IACxFW,SAAQ,KACPnB,EAAcY,OAAQ,CAAI,GAElC,CAAE,MAAOa,GACLzB,EAAcY,OAAQ,EACtBW,EAAAA,GAAQG,MAAMD,EAClB,CACJ,EAGEI,EAAwBA,KAC1B/B,EAAgBc,OAAQ,EACxBV,EAAUU,OAAQM,EAAAA,EAAAA,IAAQjB,EAAiBW,MAAM,E,o4HC9LrD,MAAMnB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://zmwk_session_archive/./src/components/loadingBox.vue","webpack://zmwk_session_archive/./src/components/loadingBox.vue?2acc","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue?829f"],"sourcesContent":["<template>\n    <div class=\"loading-box\">\n        <a-spin />\n    </div>\n</template>\n\n<script setup>\n</script>\n\n<style scoped lang=\"less\">\n.loading-box {\n    position: absolute;\n    width: 48px;\n    height: 48px;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n    text-align: center;\n}\n</style>\n","import { render } from \"./loadingBox.vue?vue&type=template&id=3d53ffb8&scoped=true\"\nconst script = {}\n\nimport \"./loadingBox.vue?vue&type=style&index=0&id=3d53ffb8&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3d53ffb8\"]])\n\nexport default __exports__","<template>\n    <MainLayout title=\"会话存档配置信息\">\n        <div class=\"zm-main-box\">\n            <LoadingBox v-if=\"loading\"/>\n            <a-form\n                v-else\n                :label-col=\"{ span: 6 }\"\n                :wrapper-col=\"{ span: 10 }\"\n                autocomplete=\"off\"\n            >\n                <div class=\"form-block\">\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">基础信息</div>\n                        <div class=\"form-block-content\">\n                            <a-form-item label=\"企业ID\">\n                                <div class=\"c595959\">{{ formState.id }}</div>\n                            </a-form-item>\n                            <a-form-item label=\"自建应用ID\">\n                                <div class=\"c595959\">{{ formState.agent_id }}</div>\n                            </a-form-item>\n                            <template v-if=\"baseInfoEdit\">\n                                <a-form-item label=\"自建应用密钥\">\n                                    <a-input v-model:value=\"formState.agent_secret\" placeholder=\"请输入自建应用密钥\"/>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button class=\"mr8\" @click=\"editBaseInfoCancel\">取 消</a-button>\n                                    <a-button type=\"primary\" @click=\"editBaseInfo\" :loading=\"baseSaving\">保 存\n                                    </a-button>\n                                </a-form-item>\n                            </template>\n                            <template v-else>\n                                <a-form-item label=\"自建应用密钥\">\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.agent_secret) }}</div>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button type=\"primary\" @click=\"baseInfoEdit = true\">修 改</a-button>\n                                </a-form-item>\n                            </template>\n                        </div>\n                    </div>\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">复制以下信息并填入到企业微信后台</div>\n                        <div class=\"form-block-content\">\n                            <a-form-item label=\"加密公钥\" class=\"label-height-unset\">\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_public_key)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.chat_public_key) }}\n                                </div>\n                            </a-form-item>\n                            <a-form-item label=\"加密私钥\" class=\"label-height-unset\">\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_private_key)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.chat_private_key, 80) }}\n                                </div>\n                            </a-form-item>\n                        </div>\n                    </div>\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">将企业微信后台会话存档配置页面的信息复制粘贴到下框中</div>\n                        <div class=\"form-block-content\">\n                            <template v-if=\"sessionInfoEdit\">\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\n                                    <a-input v-model:value=\"formState.chat_secret\" placeholder=\"请输入会话存档密钥\"/>\n                                </a-form-item>\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\n                                    <a-input-number\n                                        style=\"width: 100%;\"\n                                        :precision=\"0\"\n                                        v-model:value=\"formState.chat_public_key_version\"\n                                        placeholder=\"请输入公钥版本号\"/>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button class=\"mr8\" @click=\"editSessionInfoCancel\">取 消</a-button>\n                                    <a-button type=\"primary\" @click=\"editSessionInfo\" :loading=\"sessionSaving\">保 存\n                                    </a-button>\n                                </a-form-item>\n                            </template>\n                            <template v-else>\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.chat_secret) }}</div>\n                                </a-form-item>\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\n                                    <div class=\"c595959\">{{ formState.chat_public_key_version }}</div>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button type=\"primary\" @click=\"sessionInfoEdit = true\">修 改</a-button>\n                                </a-form-item>\n                            </template>\n                        </div>\n                    </div>\n                </div>\n            </a-form>\n        </div>\n    </MainLayout>\n</template>\n\n<script setup>\nimport {onMounted, ref} from 'vue';\nimport {message} from 'ant-design-vue';\nimport MainLayout from \"@/components/mainLayout.vue\";\nimport {getCurrentCorp, setCurrentCorp} from \"@/api/auth-login\";\nimport {copyObj, copyText, maskStringByPercentage} from \"@/utils/tools\";\nimport LoadingBox from \"@/components/loadingBox.vue\";\n\nconst loading = ref(true)\nconst baseInfoEdit = ref(false)\nconst sessionInfoEdit = ref(false)\nconst baseSaving = ref(false)\nconst sessionSaving = ref(false)\nconst formStateDefault = ref({})\nconst formState = ref({\n    id: '',\n    agent_id: '',\n    agent_secret: '',\n    chat_public_key: '',\n    chat_private_key: '',\n    chat_public_key_version: '',\n    chat_secret: '',\n})\n\nonMounted(() => {\n    loadCorpInfo()\n})\n\nconst loadCorpInfo = () => {\n    loading.value = true\n    getCurrentCorp({\n        show_config: true\n    }).then(res => {\n        formState.value = res.data || {}\n        formStateDefault.value = copyObj(formState.value)\n    }).finally(() => {\n        loading.value = false\n    })\n}\n\nconst editBaseInfo = () => {\n    if (baseInfoEdit.value) {\n        try {\n            baseSaving.value = true\n            formState.value.agent_secret = formState.value.agent_secret.trim()\n            if (!formState.value.agent_secret) {\n                throw '请输入自建应用密钥'\n            }\n            setCurrentCorp({\n                agent_secret: formState.value.agent_secret,\n            }).then(() => {\n                message.success('已保存')\n                baseInfoEdit.value = !baseInfoEdit.value\n                formStateDefault.value.agent_secret = formState.value.agent_secret\n            }).finally(() => {\n                baseSaving.value = false\n            })\n        } catch (e) {\n            baseSaving.value = false\n            message.error(e)\n        }\n    }\n}\n\nconst editBaseInfoCancel = () => {\n    baseInfoEdit.value = false\n    formState.value = copyObj(formStateDefault.value)\n}\n\nconst editSessionInfo = () => {\n    if (sessionInfoEdit.value) {\n        try {\n            sessionSaving.value = true\n            formState.value.chat_secret = formState.value.chat_secret.trim()\n            if (!formState.value.chat_secret) {\n                throw '请输入会话存档密钥'\n            }\n            if (!formState.value.chat_public_key_version) {\n                throw '请输入公钥版本号'\n            }\n            setCurrentCorp({\n                chat_secret: formState.value.chat_secret,\n                chat_public_key_version: formState.value.chat_public_key_version\n            }).then(() => {\n                message.success('已保存')\n                sessionInfoEdit.value = !sessionInfoEdit.value\n                formStateDefault.value.chat_secret = formState.value.chat_secret\n                formStateDefault.value.chat_public_key_version = formState.value.chat_public_key_version\n            }).finally(() => {\n                sessionSaving.value = false\n            })\n        } catch (e) {\n            sessionSaving.value = false\n            message.error(e)\n        }\n    }\n}\n\nconst editSessionInfoCancel = () => {\n    sessionInfoEdit.value = false\n    formState.value = copyObj(formStateDefault.value)\n}\n</script>\n\n<style scoped lang=\"less\">\n.zm-main-box {\n    background: #FFF;\n    padding-bottom: 40px;\n    min-height: calc(100vh - 120px);\n\n    :deep(.label-height-unset .ant-form-item-label >label ) {\n        height: unset;\n    }\n\n    .form-block {\n        .form-block-title {\n            color: #262626;\n            font-size: 14px;\n            font-weight: 600;\n            padding: 12px 24px;\n            border-bottom: 1px solid #F0F0F0;\n            margin-bottom: 16px;\n        }\n    }\n\n    .c595959 {\n        color: #595959;\n        word-break: break-all;\n    }\n}\n</style>\n","import script from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./authConfig.vue?vue&type=style&index=0&id=77c1c744&scoped=true&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-77c1c744\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_a_spin","script","__exports__","render","loading","ref","baseInfoEdit","sessionInfoEdit","baseSaving","sessionSaving","formStateDefault","formState","id","agent_id","agent_secret","chat_public_key","chat_private_key","chat_public_key_version","chat_secret","onMounted","loadCorpInfo","value","getCurrentCorp","show_config","then","res","data","copyObj","finally","editBaseInfo","trim","setCurrentCorp","message","success","e","error","editBaseInfoCancel","editSessionInfo","editSessionInfoCancel"],"sourceRoot":""}